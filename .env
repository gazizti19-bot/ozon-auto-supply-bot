# ================= BASE / OZON =================
OZON_CLIENT_ID=1428745
OZON_API_KEY=86e8617d-3d52-487b-b58c-ae04a38b8166
OZON_CARGO_TYPE_DEFAULT=BOX

# ================= ACCESS CONTROL (ALLOW BY TELEGRAM USERNAME) =================
# Разрешённые usernames: можно указывать с @ или без, регистр не важен (пример ниже замените на ваших трёх)
ALLOWED_USERNAMES=@gazizti,@,@user3
# (опционально) Разрешённые числовые user_id (можно оставить пустым)
ALLOWED_USER_IDS=
# (опционально) Сообщение отказа для неразрешённых пользователей; если пусто — апдейты просто игнорируются
ACL_DENY_MESSAGE=Доступ к этому боту ограничен. Обратитесь к администратору.

# ================= RATE LIMIT / BACKOFF (ускоренный, но безопасный) =================
RATE_LIMIT_DEFAULT_COOLDOWN=30
RATE_LIMIT_MAX_ON429=60
ON429_SHORT_RETRY_SEC=10
OZON_HTTP_HARD_TIMEOUT_SECONDS=8
API_TIMEOUT_SECONDS=15
TASK_STEP_TIMEOUT_SECONDS=30

# ================= DRAFT / CREATE SPACING =================
DRAFT_CREATE_MIN_SPACING_SECONDS=120
CREATE_QUIET_BEFORE_SEC=1.0
CREATE_QUIET_AFTER_SEC=2.0

# ================= TELEGRAM =================
TELEGRAM_BOT_TOKEN=8248717287:AAHKgMMm5KVEyYT7-O3ym6jQdh1dZhQAVeQ
TELEGRAM_TOKEN=${TELEGRAM_BOT_TOKEN}

# ================= STOCK LOGIC =================
MIN_STOCK=100
TARGET_MULTIPLIER=2
HISTORY_RETENTION_DAYS=120
HISTORY_LOOKBACK_DAYS=90
MIN_HISTORY_HOURS=6
MAX_HISTORY_POINTS=300
MAX_HISTORY_SNAPSHOTS=5000
SNAPSHOT_INTERVAL_MINUTES=30
SNAPSHOT_STALE_MINUTES=15
SNAPSHOT_MIN_REUSE_SECONDS=120
HISTORY_PRUNE_EVERY_MINUTES=360
DAILY_NOTIFY_HOUR=9
DAILY_NOTIFY_MINUTE=0
TZ=Asia/Yekaterinburg
HEALTH_WARN_LATENCY_MS=4000
SAVE_BUFFER_FLUSH_SECONDS=30

# ================= DATA DIR =================
DATA_DIR=/app/data
SKU_CACHE_FILE=/app/data/sku_cache.json

# ================= SKU LIST =================
SKU_LIST=2959863649,2855489499,2854906047,2625768907,2190914633,1985257923,1327503774,1762013830

# ================= LLM / GigaChat =================
LLM_PROVIDER=gigachat
GIGACHAT_CLIENT_ID=dd634eae-d4e2-4b3c-b727-6996ef74ebd5
GIGACHAT_CLIENT_SECRET=4774bbed-8cd1-4a6f-94a5-a27311920611
GIGACHAT_SCOPE=GIGACHAT_API_CORP
GIGACHAT_TOKEN_URL=https://ngw.devices.sberbank.ru:9443/api/v2/oauth
GIGACHAT_API_URL=https://gigachat.devices.sberbank.ru/api/v1/chat/completions
GIGACHAT_MODEL=GigaChat
GIGACHAT_TEMPERATURE=0.30
GIGACHAT_MAX_TOKENS=800
GIGACHAT_TIMEOUT_SECONDS=30
GIGACHAT_TOKEN_CACHE=keys/gigachat_token_cache.json
GIGACHAT_SSL_MODE=custom
GIGACHAT_CA_CERT=/app/ca/gigachat_ca.pem
GIGACHAT_VERIFY_SSL=1
AI_MIN_INTERVAL_SECONDS=5

# ================= FACT / AI =================
LLM_ENABLE_ANSWER_CACHE=1
LLM_STYLE_ENABLED=1
DEFAULT_CHAT_MODE=fact
LLM_GENERAL_TEMPERATURE=0.70
LLM_TOP_DEFICITS=20
LLM_TOP_WAREHOUSES=8
LLM_TOP_CLUSTERS=8
LLM_MAX_CONTEXT_SKU=10
LLM_MAX_CONTEXT_WAREHOUSES=6
LLM_INVENTORY_SAMPLE_SKU=50
LLM_FULL_DETAIL_SKU=25
LLM_FULL_DETAIL_WAREHOUSES=6
LLM_FACT_SOFT_LIMIT_CHARS=18000
GENERAL_HISTORY_MAX=12

# ================= AUTO SUPPLY (BASE) =================
SUPPLY_TASK_FILE=supply_tasks.json
SUPPLY_BACKOFF_BASE=600
SUPPLY_BACKOFF_MAX=7200
SUPPLY_WATCH_INTERVAL_MINUTES=5
SUPPLY_EARLY_SECONDS=2419200
SUPPLY_PURGE_AGE_DAYS=7
SUPPLY_WAREHOUSE_MAP=СОФЬИНО_РФЦ=1020000241710000,ДОМОДЕДОВО_РФЦ=1020001853757000,ЖУКОВСКИЙ_РФЦ=1020000115166000,ГРИВНО_РФЦ=1020000435290000,ПЕТРОВСКОЕ_РФЦ=23948599159000,ПУШКИНО_1_РФЦ=23843917228000,ПУШКИНО_2_РФЦ=23902289166000,ТВЕРЬ_РФЦ=23021125185000,ХОРУГВИНО_РФЦ=15431806189000,НОГИНСК_РФЦ=1020000759116000,Хоругвино_РФЦ_НЕГАБАРИТ=19262731541000,ГРИВНО_РФЦ_НЕГАБАРИТ=1020000989855000,РАДУМЛЯ_РФЦ_НЕГАБАРИТ=1020002007811000,ХОРУГВИНО_РФЦ_ПАЛЛЕТНЫЙ=1020002458344000,ПАВЛО_СЛОБОДСКОЕ_РФЦ_НЕГАБАРИТ=1020000268887000,НОГИНСК_РФЦ_НЕГАБАРИТ=1020001642383000,Тверь_Хаб=6048863967000,ЯРОСЛАВЛЬ_РФЦ=1020002006967000,СПБ_КОЛПИНО_РФЦ=1020001649180000,СПБ_БУГРЫ_РФЦ=23903599483000,СПБ_ШУШАРЫ_РФЦ=1020000613861000,Санкт_Петербург_РФЦ=18044249781000,СПБ_ШУШАРЫ_РФЦ_НЕГАБАРИТ=1020001025471000,СПБ_БУГРЫ_РФЦ_ЮВЕЛИРНЫЙ=1020000974650000,СПБ_ВОЛХОНКА_РФЦ_НЕГАБАРИТ=1020001443754000,СПБ_ВОЛХОНКА_2_РФЦ_ПАЛЛЕТНЫЙ=1020002458103000,Екатеринбург_РФЦ_НОВЫЙ=18044570445000,ЕКАТЕРИНБУРГ_РФЦ_НЕГАБАРИТ=1020001135128000,ЕКАТЕРИНБУРГ_РФЦ_ЮВЕЛИРНЫЙ=1020001351115000,ПЕРМЬ_РФЦ=1020001853819000,САМАРА_РФЦ=23128509046000,САМАРА_РФЦ_НЕГАБАРИТ=1020001443623000,САМАРА_РФЦ_ЮВЕЛИРНЫЙ=1020001351192000,НИЖНИЙ_НОВГОРОД_РФЦ=23599177351000,Казань_РФЦ_НОВЫЙ=18044494830000,КЗН_СТОЛБИЩЕ_РФЦ_НЕГАБАРИТ=1020002066005000,АДЫГЕЙСК_РФЦ=1020000267736000,НОВОРОССИЙСК_МРФЦ=23601604393000,АДЫГЕЙСК_РФЦ_ЮВЕЛИРНЫЙ=1020000974583000,Ростов_на_Дону_РФЦ=17717042026000,ЮЖНЫЙ_ОБХОД_РФЦ=1020001513671000,ВОРОНЕЖ_МРФЦ=23684735180000,ВОРОНЕЖ_РФЦ_НЕГАБАРИТ=1020002196480000,ВОРОНЕЖ_РФЦ_2=1020001007805000,ОМСК_РФЦ=1020001835468000,НОВОСИБИРСК_РФЦ_ЮВЕЛИРНЫЙ=1020001351145000,Новосибирск_РФЦ_НОВЫЙ=18044341087000,НЕВИННОМЫССК_РФЦ=1020001351243000,УФА_РФЦ=1020001836298000,УФА_РФЦ_КРОССДОКИНГ=1020001836368000,ОРЕНБУРГ_РФЦ=1020001836200000,ХАБАРОВСК_2_РФЦ=1020000890160000,ТЮМЕНЬ_РФЦ=1020002007530000,КРАСНОЯРСК_МРФЦ=22296628035000,САРАТОВ_РФЦ=1020001853897000,ВОЛГОГРАД_МРФЦ=1020000310035000,КАЛИНИНГРАД_МРФЦ=22294782253000,АСТАНА_РФЦ=1020000367015000,АЛМАТЫ_2_РФЦ=1020001854016000

# ================= AUTO SUPPLY (EXTENDED STEPS) =================
SLOT_POLL_INTERVAL_SECONDS=60
OPERATION_POLL_INTERVAL_SECONDS=15
OPERATION_POLL_TIMEOUT_SECONDS=3600
SUPPLY_JOB_INTERVAL=45
SUPPLY_MAX_OPERATION_RETRIES=200
SUPPLY_MAX_CAPACITY_RETRIES=200
SLOT_MATCH_TOLERANCE_MINUTES=0
AUTO_CREATE_CARGOES=1
AUTO_CREATE_LABELS=1
AUTO_SEND_LABEL_PDF=1
AUTO_BOOK_PASS=1
SUPPLY_TYPE_DEFAULT=CREATE_TYPE_CROSSDOCK

# ================= DROP-OFF =================
OZON_DROP_OFF_NAME=УФА_РФЦ_КРОССДОКИНГ
OZON_DROP_OFF_ID=1020001836368000
OZON_DROP_OFF_TZ=Asia/Yekaterinburg
OZON_TS_MODE=ALIGN
OZON_WAREHOUSE_TZ_MAP={"15431806189000":"Europe/Moscow","1020001836368000":"Asia/Yekaterinburg"}

SLOT_SEARCH_DAYS=28
SLOT_STRICT_DROP_ONLY=0
STRICT_DROP_ONLY=0

# ================= LOGGING / MISC =================
LOG_LEVEL=DEBUG
PURGE_TASKS_ON_BOOT=1

# ================= SUPPLY WATCH =================
SUPPLY_TIMESLOT_SEARCH_EXTRA_DAYS=0
SUPPLY_MAX_DRAFTS_PER_TICK=1
SUPPLY_MAX_SUPPLY_CREATES_PER_TICK=1
SUPPLY_CREATE_STAGE_DELAY_SECONDS=15
SUPPLY_CREATE_MIN_RETRY_SECONDS=20
SUPPLY_CREATE_MAX_RETRY_SECONDS=90
DROP_ID=1020001836368000
SUPPLY_ALLOW_LEGACY_SET_TIMESLOT=1
SUPPLY_DISABLE_INTERNAL_GATE=0
SELF_WAKEUP_THRESHOLD_SECONDS=5
ORDER_FAST_POLL_SECONDS=5
ORDER_FAST_POLL_WINDOW_SECONDS=600
TIMESLOT_MONITOR_ENABLED=1
TIMESLOT_MONITOR_RANGE_MIN=60
TIMESLOT_MONITOR_POLL_SECONDS=60
TIMESLOT_MONITOR_DEADLINE_BUFFER_MIN=30
TIMESLOT_MONITOR_PING_INTERVAL_SECONDS=10800
TIMESLOT_ALLOW_FALLBACK=0
MONITOR_ENTER_NOTIFY=1

# ================= TIMESLOT / INFO =================
TS_INFO_USE_BUNDLE_ID=1
TS_INFO_STRICT_DROP_ONLY=1
TS_INFO_ALLOW_NO_DROP_FALLBACK=0
TIMESLOT_INFO_MIN_SPACING_SECONDS=1.0

# ================= ПРОБЫ СЛОТОВ =================
TS_PROBE_MODE=concentric
TS_PROBE_PAUSE_SECONDS=30
TS_PROBE_MAX_RADIUS_MIN=120
TS_PROBE_ORDER=past-first
TS_PROBE_STRICT_MATCH_ONLY=1
TS_WID_PROBE_CONCENTRIC=1

# ================= HORIZON =================
TS_FORWARD_HORIZON_DAYS=28
TS_HORIZON_WAKE_BUFFER_MIN=10
TS_REQUIRE_SET_BEFORE_CREATE=1

# ================= SET SLOT BEHAVIOR =================
TS_SET_USE_ID_ONLY=1
TS_SET_READY_DELAY_SEC=3
TS_ID_HYDRATE_MAX_TRIES=3
TS_ID_HYDRATE_RETRY_SEC=2
STRICT_TARGET_WID=0
ROUTE_VALIDATE_WID=1

# ================= CAPACITY =================
CAPACITY_ENFORCE=1
CAPACITY_MODE=boxes
CAPACITY_REQUIRE_NUMERIC=0

# ================= RATE LIMIT / HTTPX =================
OZON_DOMAINS=api-seller.ozon.ru
OZON_RPM=2
OZON_BURST=1
OZON_NO_RETRY_ALL=1
OZON_NO_RETRY_ENDPOINTS=/v1/draft/create,/v1/draft/supply/create
OZON_PER_SECOND_COOLDOWN_SEC=8
OZON_CREATE_ENDPOINT_MIN_GAP_SEC=120
OZON_ALIGN_SECOND_BOUNDARY=0
OZON_JITTER_MS=250
OZON_CREATE_ON429_SKIP_MINUTES=0
OZON_CREATE_ON429_BLACKLIST_TTL_SEC=180
OZON_CREATE_FORCE_ROTATE_ON429=1

# ================= TIMESLOT PATCH =================
OZON_USE_CLUSTER_WIDS=1
DISABLE_TS_FALLBACK=1
OZON_TIMESLOT_DISABLE_FALLBACK=1
OZON_DISCOVER_DROPOFFS=0
DISCOVER_DROPOFFS=0
STUB_FBO_LIST=1
HTTPX_TS_DISCOVER_DROПОFFS=0
TS_INFO_USE_CLUSTER_WIDS=0
TS_INFO_MAX_WIDS_PER_CALL=1
TS_INFO_BATCH_SLEEP_MS=0

# ================= АВТОСТАРТ / ГОРИЗОНТ =================
AUTO_BOOK=True
DAYS=28
AUTO_BOOK_FORCE=True

# ================= MISC =================
EARLY_SUPPLY_SECONDS=2419200